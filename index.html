<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f5f5;
            padding: 10px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            overflow: visible;
        }

        .header {
            background: #333;
            color: white;
            padding: 15px;
            text-align: center;
        }

        .tabs {
            display: flex;
            background: #eee;
        }

        .tab {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            color: #666;
        }

        .tab.active {
            background: white;
            color: #333;
            font-weight: bold;
        }

        .content {
            padding: 15px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            font-size: 18px;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        input:focus, textarea:focus {
            border-color: #007bff;
            outline: none;
        }

        .btn {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 10px;
        }

        .btn:active {
            background: #0056b3;
        }

        .btn-danger {
            background: #dc3545;
        }

        .suggestions {
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            max-height: 200px;
            overflow-y: auto;
            position: absolute;
            width: calc(100% - 30px);
            z-index: 9999;
            display: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .suggestion {
            padding: 12px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }

        .suggestion:hover {
            background: #f0f0f0;
        }

        .suggestion:last-child {
            border-bottom: none;
        }

        .supplier-section {
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .supplier-header {
            background: #007bff;
            color: white;
            padding: 12px;
            font-weight: bold;
        }

        .supplier-contact {
            font-size: 14px;
            opacity: 0.9;
        }

        .item {
            padding: 10px 12px;
            background: #f8f9fa;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .item:last-child {
            border-bottom: none;
        }

        .remove-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 5px 8px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 14px;
        }

        .supplier-card {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .supplier-buttons {
            margin-top: 10px;
        }

        .btn-edit {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 8px;
        }

        .supplier-items {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }

        .empty {
            text-align: center;
            padding: 30px;
            color: #666;
        }

        .recent-add {
            background: #28a745;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            text-align: center;
        }

        .input-container {
            position: relative;
        }

        .unknown-supplier {
            background: #ffc107;
        }

        @media (max-width: 480px) {
            body {
                padding: 5px;
            }
            
            .header {
                padding: 10px;
                font-size: 18px;
            }
            
            .tab {
                padding: 10px 8px;
                font-size: 14px;
            }
            
            .content {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Inventory Tracker</h1>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('quick')">Add Item</button>
            <button class="tab" onclick="showTab('orders')">Orders</button>
            <button class="tab" onclick="showTab('setup')">Setup</button>
        </div>

        <div class="content">
            <div id="quick-tab" class="tab-content active">
                <div class="input-container">
                    <input type="text" id="quick-input" placeholder="Type: butter, cod, etc..." />
                    <div id="suggestions" class="suggestions"></div>
                </div>
                <button class="btn" onclick="addItem()">Add</button>
                
                <div id="recent" style="display: none;">
                    <div id="recent-msg" class="recent-add"></div>
                </div>
            </div>

            <div id="orders-tab" class="tab-content">
                <div id="orders-content">
                    <div class="empty">No items to order yet</div>
                </div>
            </div>

            <div id="setup-tab" class="tab-content">
                <input type="text" id="supplier-name" placeholder="Supplier name" />
                <input type="text" id="supplier-phone" placeholder="Phone number" />
                <input type="text" id="supplier-contact" placeholder="Contact person" />
                <textarea id="supplier-items" placeholder="Items (comma separated): cod, salmon, shrimp" rows="3"></textarea>
                <button class="btn" onclick="addSupplier()">Add Supplier</button>
                
                <div id="suppliers-list">
                    <div class="empty">No suppliers yet</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let suppliers = [];
        let neededItems = [];

        window.onload = function() {
            loadData();
            renderAll();
        };

        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        function findSupplier(itemName) {
            const search = itemName.toLowerCase().trim();
            for (let supplier of suppliers) {
                for (let item of supplier.items) {
                    if (item.toLowerCase().includes(search) || search.includes(item.toLowerCase())) {
                        return supplier;
                    }
                }
            }
            return null;
        }

        function showSuggestions() {
            const input = document.getElementById('quick-input');
            const suggestionsDiv = document.getElementById('suggestions');
            const query = input.value.toLowerCase().trim();

            if (query.length < 1) {
                suggestionsDiv.style.display = 'none';
                return;
            }

            let suggestions = [];
            suppliers.forEach(supplier => {
                supplier.items.forEach(item => {
                    if (item.toLowerCase().includes(query)) {
                        suggestions.push({ item, supplier });
                    }
                });
            });

            if (suggestions.length > 0) {
                suggestionsDiv.innerHTML = suggestions.map(s => 
                    `<div class="suggestion" onclick="selectItem('${s.item}')">
                        ${s.item} (${s.supplier.name})
                    </div>`
                ).join('');
                suggestionsDiv.style.display = 'block';
            } else {
                suggestionsDiv.style.display = 'none';
            }
        }

        function selectItem(item) {
            document.getElementById('quick-input').value = item;
            document.getElementById('suggestions').style.display = 'none';
            addItem();
        }

        function addItem() {
            const input = document.getElementById('quick-input');
            const itemName = input.value.trim();

            if (!itemName) return;

            const supplier = findSupplier(itemName);
            const supplierId = supplier ? supplier.id : null;
            const supplierName = supplier ? supplier.name : 'Unknown';

            // Check if already exists
            const exists = neededItems.find(item => 
                item.name.toLowerCase() === itemName.toLowerCase() && 
                item.supplierId === supplierId
            );

            if (!exists) {
                neededItems.push({
                    id: Date.now(),
                    name: itemName,
                    supplierId: supplierId,
                    supplierName: supplierName
                });
                
                saveData();
                showRecent(`Added "${itemName}" â†’ ${supplierName}`);
            }

            input.value = '';
            document.getElementById('suggestions').style.display = 'none';
            renderOrders();
            input.focus();
        }

        function showRecent(message) {
            const recentDiv = document.getElementById('recent');
            const msgDiv = document.getElementById('recent-msg');
            
            msgDiv.textContent = message;
            recentDiv.style.display = 'block';
            
            setTimeout(() => {
                recentDiv.style.display = 'none';
            }, 2000);
        }

        function removeItem(id) {
            neededItems = neededItems.filter(item => item.id !== id);
            saveData();
            renderOrders();
        }

        function addSupplier() {
            const name = document.getElementById('supplier-name').value.trim();
            const phone = document.getElementById('supplier-phone').value.trim();
            const contact = document.getElementById('supplier-contact').value.trim();
            const itemsText = document.getElementById('supplier-items').value.trim();

            if (!name || !itemsText) {
                alert('Need supplier name and items');
                return;
            }

            const items = itemsText.split(',').map(item => item.trim()).filter(item => item);

            suppliers.push({
                id: Date.now(),
                name,
                phone,
                contact,
                items
            });

            saveData();

            // Clear form
            document.getElementById('supplier-name').value = '';
            document.getElementById('supplier-phone').value = '';
            document.getElementById('supplier-contact').value = '';
            document.getElementById('supplier-items').value = '';

            renderSuppliers();
        }

        function editSupplier(id) {
            const supplier = suppliers.find(s => s.id === id);
            if (!supplier) return;

            // Fill form with existing data
            document.getElementById('supplier-name').value = supplier.name;
            document.getElementById('supplier-phone').value = supplier.phone || '';
            document.getElementById('supplier-contact').value = supplier.contact || '';
            document.getElementById('supplier-items').value = supplier.items.join(', ');

            // Delete the old supplier
            suppliers = suppliers.filter(s => s.id !== id);
            
            // Update any existing needed items to point to "editing" state
            neededItems.forEach(item => {
                if (item.supplierId === id) {
                    item.supplierId = null;
                    item.supplierName = 'Unknown';
                }
            });

            renderAll();
            
            // Focus on name field
            document.getElementById('supplier-name').focus();
        }

        function saveData() {
            localStorage.setItem('suppliers', JSON.stringify(suppliers));
            localStorage.setItem('neededItems', JSON.stringify(neededItems));
        }

        function loadData() {
            const savedSuppliers = localStorage.getItem('suppliers');
            const savedItems = localStorage.getItem('neededItems');
            
            if (savedSuppliers) {
                suppliers = JSON.parse(savedSuppliers);
            }
            
            if (savedItems) {
                neededItems = JSON.parse(savedItems);
            }
        }

        function deleteSupplier(id) {
            if (confirm('Delete supplier?')) {
                suppliers = suppliers.filter(s => s.id !== id);
                neededItems = neededItems.filter(item => item.supplierId !== id);
                saveData();
                renderAll();
            }
        }

        function clearAllItems() {
            if (confirm('Clear all items?')) {
                neededItems = [];
                saveData();
                renderOrders();
            }
        }

        function renderOrders() {
            const container = document.getElementById('orders-content');
            
            if (neededItems.length === 0) {
                container.innerHTML = '<div class="empty">No items to order yet</div>';
                return;
            }

            // Group by supplier
            const grouped = {};
            neededItems.forEach(item => {
                const key = item.supplierId || 'unknown';
                if (!grouped[key]) grouped[key] = [];
                grouped[key].push(item);
            });

            let html = '<button class="btn btn-danger" onclick="clearAllItems()">Clear All</button>';
            
            Object.keys(grouped).forEach(supplierId => {
                const items = grouped[supplierId];
                const supplier = suppliers.find(s => s.id == supplierId);
                
                if (supplier) {
                    html += `
                        <div class="supplier-section">
                            <div class="supplier-header">
                                ${supplier.name}
                                <div class="supplier-contact">
                                    ${supplier.phone || ''} ${supplier.contact || ''}
                                </div>
                            </div>
                            ${items.map(item => `
                                <div class="item">
                                    <span>${item.name}</span>
                                    <button class="remove-btn" onclick="removeItem(${item.id})">Ã—</button>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else {
                    html += `
                        <div class="supplier-section">
                            <div class="supplier-header unknown-supplier">
                                Unknown Supplier
                            </div>
                            ${items.map(item => `
                                <div class="item">
                                    <span>${item.name}</span>
                                    <button class="remove-btn" onclick="removeItem(${item.id})">Ã—</button>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }
            });

            container.innerHTML = html;
        }

        function renderSuppliers() {
            const container = document.getElementById('suppliers-list');
            
            if (suppliers.length === 0) {
                container.innerHTML = '<div class="empty">No suppliers yet</div>';
                return;
            }

            const html = suppliers.map(supplier => `
                <div class="supplier-card">
                    <strong>${supplier.name}</strong>
                    ${supplier.phone ? `<br>ðŸ“ž ${supplier.phone}` : ''}
                    ${supplier.contact ? `<br>ðŸ‘¤ ${supplier.contact}` : ''}
                    <div class="supplier-items">Items: ${supplier.items.join(', ')}</div>
                    <div class="supplier-buttons">
                        <button class="btn-edit" onclick="editSupplier(${supplier.id})">Edit</button>
                        <button class="remove-btn" onclick="deleteSupplier(${supplier.id})">Delete</button>
                    </div>
                </div>
            `).join('');

            container.innerHTML = html;
        }

        function renderAll() {
            renderOrders();
            renderSuppliers();
        }

        // Event listeners
        document.getElementById('quick-input').addEventListener('input', showSuggestions);
        document.getElementById('quick-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') addItem();
        });

        document.addEventListener('click', function(e) {
            if (!e.target.closest('.input-container')) {
                document.getElementById('suggestions').style.display = 'none';
            }
        });
    </script>
</body>
</html>